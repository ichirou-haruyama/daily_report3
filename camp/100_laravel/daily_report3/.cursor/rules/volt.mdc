---
alwaysApply: true
---

# Volt ルール（Livewire v3）

## コンポーネント基本
- 画面単位で `resources/views/livewire/{feature}/{name}.blade.php`
- 最上部にPHPブロックで `state()`, `rules()`, `layout()`, `title()` を宣言
- ビジネスロジックは原則Serviceへ委譲（Fat Component禁止）

## 命名
- 検索フォーム: `reports/search`
- 日報一覧: `reports/index`
- 日報作成: `reports/create`
- 日報詳細: `reports/show`
- 設定/管理: `admin/*`

## 例：検索フォーム（Functional）
```php
<?php
use Livewire\Volt\Component;
use function Livewire\Volt\{layout, state, rules, title};
use App\Services\SheetSearchService;

layout('components.layouts.app');
title('工事検索');

state([
    'constructionId' => '',
    'prime' => '',
    'site' => '',
    'subject' => '',
    'results' => [],
    'isSearching' => false,
    'error' => '',
]);

rules([
    'constructionId' => ['nullable','string','max:64'],
    'prime' => ['nullable','string','max:100'],
    'site' => ['nullable','string','max:100'],
    'subject' => ['nullable','string','max:100'],
]);

$search = function (SheetSearchService $svc) {
    $this->validate();
    $this->isSearching = true;
    try {
        $this->results = $svc->search(
            $this->constructionId, $this->prime, $this->site, $this->subject
        );
    } catch (\Throwable $e) {
        $this->error = '検索でエラーが発生しました。';
        logger()->error($e->getMessage(), ['trace' => $e->getTraceAsString()]);
    } finally {
        $this->isSearching = false;
    }
};
?>
